<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>NoWords CharaTool 完全版</title>

<style>
  body, html {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden;
    background: #1e1e1e;
    color: #ddd;
    font-family: sans-serif;
  }

  /* 左右レイアウトのメインコンテナ */
  #container {
    display: flex;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
  }

  /* 両ウィンドウ共通 */
  .panel {
    flex: 1 1 50%;
    background: #202020;
    position: relative;
    overflow: hidden;
  }

  /* 区切りバー（ドラッグで幅変更） */
  #divider {
    width: 6px;
    background: #444;
    cursor: col-resize;
  }

  /* スライス側全体レイアウト */
  #slice-area {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
  }

  #slice-preview-wrap {
    flex: 1;
    background: #000;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  #slice-preview-canvas {
    background: #111;
  }

  #slice-settings {
    padding: 10px;
    background: #2a2a2a;
    border-top: 1px solid #444;
  }

  #slice-settings input {
    width: 60px;
    margin-right: 8px;
  }

  /* 切り出し結果リスト */
  #slice-list {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    padding: 6px;
    overflow-y: auto;
    background: #181818;
    border-top: 1px solid #333;
    height: 120px;
  }

  #slice-list canvas {
    border: 1px solid #444;
  }

  /* グリッド側 UI */
  #grid-top-ui {
    position: absolute;
    top: 10px;
    left: 10px;
    padding: 8px;
    background: rgba(0,0,0,0.5);
    border-radius: 6px;
  }
  #grid-top-ui input {
    width: 70px;
    margin-right: 5px;
  }

  #grid-canvas {
    background: #111;
    display: block;
    margin: 0;
  }
</style>
</head>
<body>

<div id="container">

  <!-- ▼ 左：スライスウィンドウ -------------------------------- -->
  <div id="sliceWindow" class="panel">

    <div id="slice-area">
      
      <!-- スライスプレビュー -->
      <div id="slice-preview-wrap">
        <canvas id="slice-preview-canvas" width="300" height="300"></canvas>
      </div>

      <!-- スライス設定フォーム -->
      <div id="slice-settings">

        <div style="margin-bottom:6px;">
          <input type="file" id="slice-file">
        </div>

        <label>W:</label><input id="slice-w" type="number" value="64">
        <label>H:</label><input id="slice-h" type="number" value="64">
        <label>Cols:</label><input id="slice-cols" type="number" value="3">
        <label>Rows:</label><input id="slice-rows" type="number" value="4">

        <br><br>

        <label>OffX:</label><input id="slice-offx" type="number" value="0">
        <label>OffY:</label><input id="slice-offy" type="number" value="0">

        <button id="slice-run" style="margin-left:10px;">切り出し</button>
      </div>

      <!-- スライス結果リスト -->
      <div id="slice-list"></div>

    </div>
  </div>

  <!-- ▼ 真ん中：ドラッグ境界 -------------------------------- -->
  <div id="divider"></div>


  <!-- ▼ 右：配置グリッド -------------------------------- -->
  <div id="gridWindow" class="panel">

    <!-- グリッド上の設定 UI -->
    <div id="grid-top-ui">
      <div>
        <label>Cols:</label>
        <input id="grid-cols" type="number" value="9">

        <label>Rows:</label>
        <input id="grid-rows" type="number" value="6">
      </div>

      <div style="margin-top:6px;">
        <label>CellW:</label>
        <input id="cell-width" type="number" value="64">

        <label>CellH:</label>
        <input id="cell-height" type="number" value="64">

        <button id="grid-apply">適用</button>
      </div>

      <div style="margin-top:10px;">
        選択セル：<span id="selected-pos">なし</span>
      </div>

      <div style="margin-top:8px;">
        OffX:<input id="offset-x" type="number" value="0">
        OffY:<input id="offset-y" type="number" value="0">
      </div>

      <!-- 微調整ボタン -->
      <div id="offset-buttons" style="margin-top:8px; display:flex; gap:4px; flex-wrap:wrap;">
        <button data-move="up">↑</button>
        <button data-move="down">↓</button>
        <button data-move="left">←</button>
        <button data-move="right">→</button>
        <button id="offset-reset">リセット</button>
      </div>

      <!-- 行・列調整 -->
      <div style="margin-top:10px;">
        Row:<input id="row-target" type="number" value="0" style="width:40px;">
        <button id="row-up">↑行</button>
        <button id="row-down">↓行</button>
      </div>

      <div style="margin-top:6px;">
        Col:<input id="col-target" type="number" value="0" style="width:40px;">
        <button id="col-left">←列</button>
        <button id="col-right">→列</button>
      </div>

      <div style="margin-top:10px;">
        <button id="save-png">PNG保存</button>
      </div>
    </div>

    <!-- 配置グリッド -->
    <canvas id="grid-canvas"></canvas>
  </div>

</div>
